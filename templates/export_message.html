{#
Export one saved message from the database.
Variables:
  - date: message date
  - dialog_title: dialog title
  - text: message text
  - files: list of message files
#}

<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<head>
    <title>{{ date }} {{ dialog_title }}</title>

    <style>
        /* Built-in styles for standalone HTML file / Встроенные стили для автономного HTML файла */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        /* Media files area / Область медиафайлов */
        .media-files-area {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        /* Media files in a single column / Медиафайлы в одну колонку */
        .media-files-one-column {
            width: 90%;
            height: 90vh;
        }
        /* Media files in two columns / Медиафайлы в две колонки */
        .media-files-two-column {
            width: 45%;
            height: 45vh;
        }
        /* Container for media files / Контейнер для медиафайлов */
        .media-files-container {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        /* File name output / Вывод названия файла */
        .media-file-name {
            text-align: center;
            margin-top: 5px;
        }
    </style>

</head>
<body>
<div style="text-align: center;">

    {# Displaying the date of the message / Вывод даты сообщения #}
    <b>{{ date }}</b>

    {# Displaying the beginning of the dialog title / Вывод начала названия диалога #}
    <span style="color: #777777">&nbsp;&nbsp;|&nbsp;&nbsp; {{ dialog_title|safe|truncate(constants.truncated_title_length) }}</span>
</div>

{# Displaying the message text / Вывод текста сообщения #}
{% if text %}
    <br>
    {{ text|replace('\n', '<br>')|safe }}
{% endif %}

{# Displaying of graphics, video, and other files / Вывод графических, видео и других файлов #}
{% if files %}
    <br>
    <div class="media-files-area">
        {% for message_file in files %}
            <div class="{% if files|length>1 %} media-files-two-column {% else %} media-files-one-column {% endif %}">

                {# Displaying of graphics files / Вывод графических файлов #}
                {% if message_file.alt_text==tg_file_types.IMAGE.alt_text %}
                    <img class="media-files-container"
                         src="{{ message_file.file_name }}" alt="{{ message_file.alt_text }}">
                {% endif %}

                {# Displaying of video files / Вывод видео файлов #}
                {% if message_file.alt_text==tg_file_types.VIDEO.alt_text %}
                    <video class="media-files-container"
                           src="{{ message_file.file_name }}" controls preload="metadata">
                        Video is not supported by your browser
                    </video>
                {% endif %}

                {# Displaying file name / Вывод имени файла #}
                <div class="media-file-name">
                    {{ message_file.file_name }}
                </div>
            </div>
        {% endfor %}
    </div>
{% endif %}

</body>
</html>